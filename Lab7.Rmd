---
title: "Lab7"
author: "Your Name"
date: "2024-10-17"
output: "github_document"
---
# Load packages and dataset
```{r}
library(haven)
library(bruceR)
library(dplyr)
library(ggstatsplot)
library(performance)
library(sjPlot)

ex <- read_sav("C:/Users/vtrip/OneDrive/Documents/GitHub/Lab7/ex.sav")

lab7<-read.csv("C:/Users/vtrip/OneDrive/Documents/GitHub/Lab7/Lab7.csv")



```

# Correlation
```{r}
#First, you will need to select variables or composites of interest

ex <- ex %>%
  select(Conscientiousness, AverageHoursofSleep, GPA)

#The Corr function also gives you a correlation plot between all variables, but it doesn't look pretty enough and not very customizable

Corr(ex)

#If you hate the correlation plot design, you can use the following function
ggcorrmat(ex)

#If you want to visualize the correlation between two specifcic variables, you can use the following code
ggplot(ex, aes(x = Conscientiousness, y = GPA)) + geom_point() + geom_smooth() + theme_bruce()

#Note that the line will naturally follow the data points, but you can specify to plot the fittest line by adding method = lm to the geom_smooth() function
ggplot(ex, aes(x = Conscientiousness, y = GPA)) + geom_point() + geom_smooth(method = lm) + theme_bruce()




```

# Regression
```{r}
#step 1: build a model
model<-lm(GPA ~ Conscientiousness + AverageHoursofSleep, data = ex)
#linear model, GPA if being predicted by conscientiousness and average sleep hours

#step 2: check the assumptions
check_model(model)
#linearity, homogeneity, colinearity is the relevant plot. Co-linearity is MOST IMPORTANT

#step 3: summarize results; add ,std = TRUE if you want to get standardized coefficients
model_summary(model)
#in this case, conscienteousness is a sig predictor of GPA, when controlling for sleep


# or using the tab_model functional; add  ,show.std = TRUE if you want to get standardized coefficients
tab_model(model)

#step 4: plot the results; change type ="est" to type = "std" if you want to plot the standardized coefficients
plot_model(model,  type ="est",  show.values = TRUE, vline.color = "#1B191999", line.size = 1.5, dot.size = 2.5, colors = "blue") + theme_bruce()

```



# Q1: Use the Corr or the ggcorrmat function to plot the correlation between all variables. Which personality traits are correlated with satisfaction with life and which one is not? All of the variables, except for openness are correlated with SWL.  

```{r}

Corr(lab7)


```

# Q2: Run a multiple regression using the Big 5 personality traits to predict satisfaction with life and plot the results
```{r}
#for this lab assignment you would assume assumptions are met, but for your own analysis, you will need to examine assumptions carefully
model<-lm(SWL ~ Conscientiousness + Openness + EmotionalStability + Agreeableness + Extraversion, data = lab7)

model_summary(model)
tab_model(model)

plot_model(model,  type ="est",  show.values = TRUE, vline.color = "#1B191999", line.size = 1.5, dot.size = 2.5, colors = "blue") + theme_bruce()

```

# Q3: Interpret the R2. Which personality trait(s) can explain unique variance in satisfaction with life when controlling for each other, and which ones cannot? If someone asks you for advice on how to improve life satisfaction, based on your results, which personality trait would you recommend them to change and why? 

The intercept represents what the satisfaction of life would be if the values of all personality traits was zero. The SWL would be 2.191.

One unit increase in Extraversion results in 0.14 increase in SWL
One unit increase in Agreeableness results in a 0.062 increase in SWL
One unit increase in Emotional Stability results in a 0.134 increase in SWL
One unit increase in Openness results in a 1.01 DECREASE in SWL
One unit increase in Conscientiousness results in a 0.019 increase in SWL

Openness, emotional stability and extraversion uniquely explain 13.5% of the variance. The other two traits are not significant. I would recommend they focus on increasing their extraversion because it had the largest coefficient. The reason we can compare the values without standardizing is because all traits are measured on the same scale.